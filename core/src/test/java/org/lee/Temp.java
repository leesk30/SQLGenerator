package org.lee;

import org.lee.common.SQLFormatter;

public class Temp {
//    public static void main(String[] args) {
//        String a = "SELECT CAST(SUM(CASE WHEN winequality_red.alcohol > 8 THEN 1 ELSE 0 END) AS REAL) - SUM(CASE WHEN winequality_white.alcohol > 8 THEN 1 ELSE 0 END) AS difference FROM winequality_red, winequality_white;\n";
//        String b = "SELECT (SELECT COUNT(*) FROM winequality_red WHERE alcohol > 8) - (SELECT COUNT(*) FROM winequality_white WHERE alcohol > 8) AS difference;";
//        SQLFormatter formatter = new SQLFormatter();
//        System.out.println(formatter.format(a));
//        System.out.println(formatter.format(b));
//    }
    public static void main(String[] args) {
        String sql = "WITH CTE_992105(te_4544b7) AS (SELECT r_e35f71.hd_dep_count as te_4544b7 FROM db1.household_demographics AS r_e35f71 WHERE r_e35f71.hd_vehicle_count < r_e35f71.hd_dep_count OR r_e35f71.hd_vehicle_count != 95 OR r_e35f71.hd_demo_sk = 13 ORDER BY 1 ASC NULLS LAST) SELECT r_ad827e.te_55a033 as te_019ed3 FROM (SELECT chr(double(r_c98d4a.cc_employees) - 37 * r_883e40.cd_dep_employed_count) as te_55a033, hash(skewness(r_2aeb1d.sr_cdemo_sk)) as te_7f5815, double(r_2aeb1d.sr_return_ship_cost) as te_1e4fe7 FROM db1.call_center AS r_c98d4a INNER JOIN db1.store_returns AS r_2aeb1d ON r_c98d4a.cc_closed_date_sk != r_2aeb1d.sr_return_amt_inc_tax, (WITH CTE_035b26(te_17b22a, te_36ad58, te_e0fd4c) AS (SELECT r_c21ed1.wp_url as te_17b22a, hash((39 - r_b6feeb.ib_upper_bound) / (30.115469 - r_868a14.cd_dep_college_count)) as te_36ad58, r_c21ed1.wp_rec_start_date as te_e0fd4c FROM db1.customer_demographics AS r_868a14 LEFT JOIN db1.income_band AS r_b6feeb ON r_868a14.cd_dep_college_count > r_b6feeb.ib_lower_bound, db1.web_page AS r_c21ed1 WHERE r_868a14.cd_credit_rating != r_c21ed1.wp_web_page_id ORDER BY 1 DESC NULLS LAST, 2 NULLS LAST, 3 NULLS FIRST OFFSET 30) SELECT decimal(71.10482454D / r_1d28fa.te_36ad58) as te_cfde5e FROM CTE_035b26 AS r_1d28fa RIGHT JOIN db1.warehouse AS r_c4cb42 ON r_1d28fa.te_17b22a ILIKE r_c4cb42.w_state WHERE r_c4cb42.w_street_type NOT LIKE 'IHlpx' AND r_c4cb42.w_zip NOT LIKE 'X' ORDER BY 1 DESC LIMIT 65) AS r_737648 LEFT JOIN db1.customer_demographics AS r_883e40 ON r_737648.te_cfde5e = decimal(r_883e40.cd_dep_employed_count) WHERE r_2aeb1d.sr_net_loss != r_883e40.cd_dep_employed_count AND r_c98d4a.cc_rec_start_date != r_c98d4a.cc_rec_end_date GROUP BY r_c98d4a.cc_employees, r_2aeb1d.sr_return_ship_cost, r_883e40.cd_dep_employed_count ORDER BY 1 DESC NULLS LAST, 2 DESC NULLS LAST, 3 DESC NULLS LAST) AS r_ad827e LEFT JOIN (SELECT r_9e98bc.d_month_seq / r_9e98bc.d_fy_week_seq as te_5aa7b8 FROM db1.date_dim AS r_9e98bc RIGHT JOIN (SELECT double(unix_timestamp()) as te_05f62a FROM db1.customer_address AS r_97ff65 RIGHT JOIN (SELECT r_8bf015.w_county as te_c240e1, r_57cdff.sm_ship_mode_sk as te_9ee94f, r_8bf015.w_warehouse_name as te_0abfd8 FROM db1.ship_mode AS r_57cdff LEFT JOIN db1.warehouse AS r_8bf015 ON r_57cdff.sm_contract ILIKE r_8bf015.w_warehouse_id, db1.income_band AS r_71bdfe WHERE r_57cdff.sm_ship_mode_sk != r_71bdfe.ib_income_band_sk AND r_8bf015.w_warehouse_sq_ft BETWEEN 17 AND 17 OR r_8bf015.w_warehouse_sk < r_71bdfe.ib_income_band_sk) AS r_b6bb25 ON r_97ff65.ca_state NOT ILIKE r_b6bb25.te_c240e1 WHERE r_97ff65.ca_suite_number ILIKE 'RIv' OR r_97ff65.ca_gmt_offset >= 1.77784637 OR r_97ff65.ca_street_name ILIKE r_97ff65.ca_county ORDER BY 1 ASC NULLS LAST) AS r_943759 ON r_9e98bc.d_date = r_943759.te_05f62a ORDER BY 1 ASC NULLS LAST) AS r_cc9f88 ON r_ad827e.te_1e4fe7 >= r_cc9f88.te_5aa7b8 WHERE r_ad827e.te_1e4fe7 <= 81.93902927D OR r_ad827e.te_1e4fe7 <= r_cc9f88.te_5aa7b8 AND NOT r_ad827e.te_1e4fe7 < 8.03815751D OR r_ad827e.te_1e4fe7 >= 20.54680427D ORDER BY 1 DESC NULLS FIRST;";
        System.out.println(SQLFormatter.formatStatement(sql));
    }
}
